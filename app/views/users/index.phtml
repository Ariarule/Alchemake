<?php $this->flashSession->output();

echo "<h2>Welcome {$userinfo->nickname}</h2>";
$possible_f = array(
  'T' => function () use ($userinfo) { //trades
    echo "<h3>Trades</h3>";
    //print_r($userinfo->trades); //TODO: Write T function
  },

  'I' => function () use ($userinfo) { //inventory
    echo "<h3>Your Inventory</h3>";

    if ($userinfo->inventory->count() > 0) {
     $form_buttons = '<button formaction="/Trade/setupProposal" type="submit">Trade</button>&nbsp;'
     . '<button formaction="/Inventory/alchemake" type="submit">Alchemake'
     .'</button>';
     $this->partial('shared/inventoryTable',
        ['form_buttons' => $form_buttons,
         'inventory' => $userinfo->inventory]);
}
else {
  echo "You have no inventory right now. :(";
}   

  },

  'U' => function () use ($userinfo) { //usercard
    ?><!--
    <?php echo "{$userinfo->userid}"; ?>
    -->
    <h3>Usercard</h3>
    <div id="userinfo">
      <ul>
        <li>Basic item delivery: <?= explode($userinfo->last_drop,' ')[0] ?></li>
        <li>AY Allowence: <?= explode($userinfo->last_allowence,' ')[0] ?></li>
        <li>Email Address: <?= $userinfo->emailaddress ?></li>
      </ul>
    </div>
    <?php
  });

foreach (str_split($userinfo->main_order,1) as $section) {
  if (isset($possible_f[$section])) {
    $possible_f[$section]();
  }
}
?>
